<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Sneaker Shop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        .card { margin: 10px; }
        #cart { position: fixed; right: 20px; bottom: 20px; }
    </style>
</head>
<body>
<div class="container">
    <h1 class="my-4">Магазин кроссовок</h1>
    
    <div class="row" id="products"></div>
    
    <button id="checkoutBtn" class="btn btn-success d-none" onclick="checkout()">
        Оформить заказ ($<span id="total">0</span>)
    </button>
</div>

<script>
let cart = JSON.parse(localStorage.getItem('cart')) || {};

const products = [
    {id: 1, name: "Nike Air Max", price: 120, image: "url_изображения"},
    {id: 2, name: "Adidas Ultraboost", price: 150, image: "url_изображения"}
];

function renderProducts() {
    const container = document.getElementById('products');
    container.innerHTML = products.map(product => `
        <div class="col-md-4">
            <div class="card">
                <img src="${product.image}" class="card-img-top">
                <div class="card-body">
                    <h5>${product.name}</h5>
                    <p>$${product.price}</p>
                    <button class="btn btn-primary" 
                            onclick="addToCart(${product.id})">
                        Добавить в корзину
                    </button>
                </div>
            </div>
        </div>
    `).join('');
}

function addToCart(productId) {
    cart[productId] = (cart[productId] || 0) + 1;
    updateCart();
}

function updateCart() {
    localStorage.setItem('cart', JSON.stringify(cart));
    const total = Object.entries(cart).reduce((sum, [id, qty]) => 
        sum + (products.find(p => p.id === parseInt(id)).price * qty), 0);
    
    document.getElementById('total').textContent = total;
    document.getElementById('checkoutBtn').classList.toggle('d-none', total === 0);
}

function checkout() {
    Telegram.WebApp.showPopup({
        title: "Оформление заказа",
        message: "Введите ваши данные:",
        buttons: [{
            id: 'confirm',
            type: 'default',
            text: 'Подтвердить'
        }]
    }, async (btnId) => {
        if(btnId === 'confirm') {
            const data = {
                cart: cart,
                total: document.getElementById('total').textContent,
                date: new Date().toISOString()
            };
            Telegram.WebApp.sendData(JSON.stringify(data));
            Telegram.WebApp.close();
        }
    });
}

document.addEventListener('DOMContentLoaded', renderProducts);
</script>
</body>
</html>
